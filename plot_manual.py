from matplotlib import pyplot as plt
import numpy as np

save_path = '/home/local/data/ms/honest_llama_data'

fig, axs = plt.subplots(1,1)
# paths = ['NLSC42_hl_llama_7B_trivia_qa_greedy_responses_train5000_5000_1_layerFalse_answer_last_individual_linear_hallu_pos_bs128_epochs50_0.0005_False_fpr_at_recall',
# 'NLSC42_hl_llama_7B_trivia_qa_greedy_responses_train5000_5000_1_layerFalse_answer_last_individual_non_linear_4_hallu_pos_bs128_epochs50_5e-05_False',
# 'T42_hl_llama_7B_trivia_qa_greedy_responses_train5000_5000_1_layerFalse_answer_last_transformer_hallu_pos_bs128_epochs50_5e-05_Falseba_fpr_at_recall',
# 'T42_hl_llama_7B_trivia_qa_greedy_responses_train5000_5000_1_layerFalse_answer_last_transformer_supconv2_pos_hallu_pos_0.3_bs256_epochs500_5e-05_Falseba',
# 'T42_hl_llama_7B_trivia_qa_greedy_responses_train5000_5000_1_layerFalse_answer_last_transformer_supconv2_pos_kmeans_hallu_pos_mahalanobis_centers1_bs256_epochs500_5e-06_Falseba_bestusinglast',
# 'T42_hl_llama_7B_trivia_qa_sampledplus_responses_train5000_55000_1_layerFalse_answer_last_transformer_supconv2_pos_hallu_pos_0.05_bs352_epochs500_0.0005_Falseba_fpr_at_recall',
# 'T42_hl_llama_7B_trivia_qa_sampledplus_responses_train5000_55000_1_layerFalse_answer_last_transformer_supconv2_pos_kmeans_hallu_pos_0.05_mahalanobis_centers1_bs352_epochs500_0.0005_Falseba_bestusinglast',
# 'T42_hl_llama_7B_trivia_qa_sampledplus_responses_train5000_55000_1_layerFalse_answer_last_transformer_supconv2_pos_wp_hallu_pos_0.3_bs352_epochs500_5e-05_Falseba_fpr_at_recall',
# 'T42_hl_llama_7B_trivia_qa_sampledplus_responses_train5000_55000_1_layerFalse_answer_last_transformer_supconv2_pos_wp_kmeans_hallu_pos_0.3_mahalanobis_centers1_bs352_epochs500_0.0005_Falseba_bestusinglast'
# ]
# labels = ['linear_last_layer','nlinear_last_layer','tfmr','tfmr_supcon+','tfmr_supcon+_dist','tfmr_aug_supcon+','tfmr_aug_supcon+_dist','tfmr_aug_supcon+*','tfmr_aug_supcon+*_dist']
# paths = ['NLSC42_alpaca_7B_trivia_qa_greedy_responses_train5000_5000_1_layerFalse_answer_last_individual_linear_hallu_pos_bs128_epochs50_0.0005_False_fpr_at_recall',
# 'NLSC42_alpaca_7B_trivia_qa_greedy_responses_train5000_5000_1_layerFalse_answer_last_individual_non_linear_4_hallu_pos_bs128_epochs50_0.005_False',
# 'T42_alpaca_7B_trivia_qa_greedy_responses_train5000_5000_1_layerFalse_answer_last_transformer_hallu_pos_bs128_epochs50_0.0005_Falseba_fpr_at_recall',
# 'T42_alpaca_7B_trivia_qa_greedy_responses_train5000_5000_1_layerFalse_answer_last_transformer_supconv2_pos_hallu_pos_2.0_bs256_epochs500_5e-05_Falseba',
# 'T42_alpaca_7B_trivia_qa_greedy_responses_train5000_5000_1_layerFalse_answer_last_transformer_supconv2_pos_kmeans_hallu_pos_mahalanobis_centers1_bs256_epochs500_5e-06_Falseba_bestusinglast',
# 'T42_alpaca_7B_trivia_qa_sampledplus_responses_train5000_55000_1_layerFalse_answer_last_transformer_supconv2_pos_hallu_pos_0.5_bs352_epochs500_5e-05_Falseba_fpr_at_recall',
# 'T42_alpaca_7B_trivia_qa_sampledplus_responses_train5000_55000_1_layerFalse_answer_last_transformer_supconv2_pos_kmeans_hallu_pos_mahalanobis_centers1_bs352_epochs500_5e-06_Falseba_bestusinglast',
# 'T42_alpaca_7B_trivia_qa_sampledplus_responses_train5000_55000_1_layerFalse_answer_last_transformer_supconv2_pos_wp_hallu_pos_0.7_bs352_epochs500_5e-05_Falseba_fpr_at_recall',
# 'T42_alpaca_7B_trivia_qa_sampledplus_responses_train5000_55000_1_layerFalse_answer_last_transformer_supconv2_pos_wp_kmeans_hallu_pos_0.3_mahalanobis_centers1_bs352_epochs500_5e-05_Falseba_bestusinglast'
# ]
# labels = ['linear_last_layer','nlinear_last_layer','tfmr','tfmr_supcon+','tfmr_supcon+_dist','tfmr_aug_supcon+','tfmr_aug_supcon+_dist','tfmr_aug_supcon+*','tfmr_aug_supcon+*_dist']
paths = ['NLSC42_hl_llama_7B_nq_open_greedy_responses_train5000_5000_1_layerFalse_answer_last_individual_linear_hallu_pos_bs128_epochs50_0.005_False_fpr_at_recall',
'NLSC42_hl_llama_7B_nq_open_greedy_responses_train5000_5000_1_layerFalse_answer_last_individual_non_linear_4_hallu_pos_bs128_epochs50_5e-05_False',
'T42_hl_llama_7B_nq_open_greedy_responses_train5000_5000_1_layerFalse_answer_last_transformer_hallu_pos_bs128_epochs50_5e-05_Falseba_fpr_at_recall',
'T42_hl_llama_7B_nq_open_greedy_responses_train5000_5000_1_layerFalse_answer_last_transformer_supconv2_pos_hallu_pos_bs256_epochs500_5e-05_Falseba',
'T42_hl_llama_7B_nq_open_greedy_responses_train5000_5000_1_layerFalse_answer_last_transformer_supconv2_pos_kmeans_hallu_pos_mahalanobis_centers1_bs256_epochs500_5e-05_Falseba_bestusinglast',
'T42_hl_llama_7B_nq_open_sampledplus_responses_train5000_55000_1_layerFalse_answer_last_transformer_supconv2_pos_hallu_pos_2.0_bs352_epochs500_0.0005_Falseba',
'T42_hl_llama_7B_nq_open_sampledplus_responses_train5000_55000_1_layerFalse_answer_last_transformer_supconv2_pos_kmeans_hallu_pos_0.5_mahalanobis_centers1_bs352_epochs500_5e-05_Falseba_bestusinglast',
'T42_hl_llama_7B_nq_open_sampledplus_responses_train5000_55000_1_layerFalse_answer_last_transformer_supconv2_pos_wp_hallu_pos_2.0_bs352_epochs500_0.0005_Falseba',
'T42_hl_llama_7B_nq_open_sampledplus_responses_train5000_55000_1_layerFalse_answer_last_transformer_supconv2_pos_wp_kmeans_hallu_pos_1.0_mahalanobis_centers1_bs352_epochs500_5e-05_Falseba_bestusinglast'
]
labels = ['linear_last_layer','nlinear_last_layer','tfmr','tfmr_supcon+','tfmr_supcon+_dist','tfmr_aug_supcon+','tfmr_aug_supcon+_dist','tfmr_aug_supcon+*','tfmr_aug_supcon+*_dist']

# best using last
# paths = ['T42_alpaca_7B_trivia_qa_greedy_responses_train5000_5000_1_layerFalse_answer_last_transformer_hallu_pos_bs128_epochs50_5e-05_Falseba_bestusinglast',
# 'T42_alpaca_7B_trivia_qa_greedy_responses_train5000_5000_1_layerFalse_answer_last_transformer_supconv2_hallu_pos_1.0_bs256_epochs500_5e-05_Falseba_bestusinglast',
# 'T42_alpaca_7B_trivia_qa_sampledplus_responses_train5000_55000_1_layerFalse_answer_last_transformer_supconv2_pos_hallu_pos_bs352_epochs500_5e-06_Falseba_bestusinglast',
# 'T42_alpaca_7B_trivia_qa_sampledplus_responses_train5000_55000_1_layerFalse_answer_last_transformer_supconv2_pos_wp_hallu_pos_0.7_bs352_epochs500_5e-05_Falseba_bestusinglast'
# ]
# labels = []

for path,label in zip(paths,labels):
    if 'fpr_at_recall' not in path: path += '_fpr_at_recall'
    recall_vals = np.load(f'{save_path}/fpr_at_recall_curves/{path}_xaxis.npy')
    fpr_at_recall_vals = np.load(f'{save_path}/fpr_at_recall_curves/{path}_yaxis.npy')
    axs.plot(recall_vals,fpr_at_recall_vals,marker='o',label=label)
    # for xy in zip(recall_vals,fpr_at_recall_vals):
    #     axs.annotate('(%.2f, %.2f)' % xy, xy=xy)
axs.legend()    
axs.set_xlabel('Recall')
axs.set_ylabel('FPR')
axs.title.set_text('FPR at recall')
# fig.savefig(f'{save_path}/fpr_at_recall_curves/llama_trivia_fpr_at_recall.png')
# fig.savefig(f'{save_path}/fpr_at_recall_curves/llama_nq_fpr_at_recall.png')
fig.savefig(f'{save_path}/fpr_at_recall_curves/alpaca_trivia_fpr_at_recall.png')
# fig.savefig(f'{save_path}/fpr_at_recall_curves/alpaca_nq_fpr_at_recall.png')

# fig.savefig(f'{save_path}/fpr_at_recall_curves/llama_trivia_lwgting_fpr_at_recall.png')
# fig.savefig(f'{save_path}/fpr_at_recall_curves/alpaca_trivia_lwgting_fpr_at_recall.png')

